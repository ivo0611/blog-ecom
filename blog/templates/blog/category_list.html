{% extends "base.html" %}
{% load wagtailcore_tags %}
{% load static %}
{% load wagtailimages_tags %}
{% load blog_post_tags %}
{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-8">
            {% block m_content %}
            <div class="blog-area">
                {% if category %}
                <div class="block-title-custom-y">
                    <h3 id="bat-tu-menh-ly"><span>{{category}}</span></h3>
                </div>
                {% endif %}
                <div class="row">
                    {% if posts %}
                    <div class="col-lg-6">
                        {% with first_post=posts.0 %}
                        <article class="card card-full hover-a mb-4">
                            <div class="ratio_360-202 image-wrapper">
                                <a href="{{ first_post.post.url }}" title="{{ first_post.post.title }}">
                                    {% if first_post.image_url %}
                                    <img width="390" height="220"
                                         src="{{ first_post.image_url }}"
                                         class="img-fluid w-80 attachment-390x220 size-390x220 lazyloaded"
                                         alt="{{ first_post.post.title }}">
                                    {% endif %}
                                </a>
                            </div>
                            <div class="card-body">
                                <h2 class="card-title h1-sm h3-lg">
                                    <a href="{{ first_post.post.url }}" title="{{ first_post.post.title }}">
                                        {{first_post.post.title }}</a>
                                </h2>
                                <div class="card-text mb-2 text-muted small">
                                    <time datetime="{{ first_post.post.first_published_at|date:'Y-m-d H:i' }}">
                                        {{ first_post.post.first_published_at|date:'d/m/Y H:i' }}
                                    </time>
                                </div>
                                <p class="card-text line-clamp-3">{{ first_post.post.search_description}}</p>
                            </div>
                        </article>
                        {% endwith %}
                    </div>

                    <div class="col-lg-6">
                        {% for post in posts|slice:"1:" %}
                        <article class="card card-full hover-a mb-4">
                            <div class="row">
                                <div class="col-3 col-md-4 pe-2 pe-md-0">
                                    <div class="ratio_115-80 image-wrapper">
                                        <a href="{{ post.post.url }}" title="{{ post.post.title }}">
                                            {% if post.image_url %}
                                            <img width="125" height="80"
                                                 src="{{ post.image_url }}"
                                                 class="img-fluid w-80 attachment-125x80 size-125x80 lazyloaded"
                                                 alt="{{ post.post.title }}">
                                            {% endif %}
                                        </a>
                                    </div>
                                </div>
                                <div class="col-9 col-md-8">
                                    <div class="card-body pt-0">
                                        <h3 class="card-title h6 h5-sm h6-lg">
                                            <a href="{{ post.post.url }}" title="{{ post.post.title }}">
                                                {{post.post.title }}</a>
                                        </h3>
                                        <div class="card-text small text-muted">
                                            <time datetime="{{ post.post.first_published_at|date:'Y-m-d H:i' }}">
                                                {{ post.post.first_published_at|date:'d/m/Y H:i' }}
                                            </time>
                                        </div>
                                        <p class="card-text line-clamp-3">{{post.post.search_description}}</p>
                                    </div>
                                </div>
                            </div>
                        </article>
                        {% endfor %}
                    </div>
                    {% else %}
                    <p>Chưa có bài viết nào trong danh mục này.</p>
                    {% endif %}
                </div>  <!-- đóng row -->
    <div class="block-title-custom-x">

                </div>
                {% if posts.has_other_pages %}
                <div class="d-flex justify-content-center mt-4">
                    <nav aria-label="Pagination">
                        <ul class="pagination">
                            {% if posts.has_previous %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ posts.previous_page_number }}">&laquo;</a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <span class="page-link">&laquo;</span>
                            </li>
                            {% endif %}

                            {% for num in posts.paginator.page_range %}
                            {% if posts.number == num %}
                            <li class="page-item active">
                                <span class="page-link">{{ num }}</span>
                            </li>
                            {% else %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                            </li>
                            {% endif %}
                            {% endfor %}

                            {% if posts.has_next %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ posts.next_page_number }}">&raquo;</a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <span class="page-link">&raquo;</span>
                            </li>
                            {% endif %}
                        </ul>
                    </nav>
                </div>
                {% endif %}

            </div>  <!-- đóng blog-area -->
            {% endblock m_content %}
        </div>

        <aside class="col-md-4 end-sidebar-lg-2  mt-4">
              {% render_sidebar %}

        </aside>
    </div>
</div>
{% endblock content %}
<style>

</style>